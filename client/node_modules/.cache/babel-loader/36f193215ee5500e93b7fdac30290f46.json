{"ast":null,"code":"import _slicedToArray from\"/Users/dannytszho/Desktop/Coding/Open_Source_Projects/google-docs/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useCallback,useEffect,useState}from'react';import Quill from\"quill\";import\"quill/dist/quill.snow.css\";import{io}from'socket.io-client';import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";var SAVE_INTERVAL_MS=200;var TOOLBAR_OPTIONS=[[{header:[1,2,3,4,5,6,false]}],[{font:[]}],[{list:\"ordered\"},{list:\"bullet\"}],[\"bold\",\"italic\",\"underline\"],[{color:[]},{background:[]}],[{script:\"sub\"},{script:\"super\"}],[{align:[]}],[\"image\",\"blockquote\",\"code-block\"],[\"clean\"]];export default function TextEditor(){var _useParams=useParams(),documentID=_useParams.id;var _useState=useState(),_useState2=_slicedToArray(_useState,2),socket=_useState2[0],setSocket=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),quill=_useState4[0],setQuill=_useState4[1];console.log(documentID);useEffect(function(){var s=io(\"http://localhost:3001\");setSocket(s);return function(){s.disconnect();};},[]);useEffect(function(){if(socket==null||quill==null)return;socket.once('load-document',function(document){quill.setContents(document);quill.enable();});socket.emit('get-document',documentID);},[socket,quill],documentID);useEffect(function(){if(socket==null||quill==null)return;var interval=setInterval(function(){socket.emit(\"save-document\",quill.getContents());},SAVE_INTERVAL_MS);return function(){clearInterval(interval);};},[socket,quill]);useEffect(function(){if(socket==null||quill==null)return;var handler=function handler(delta){quill.updateContents(delta);};socket.on('receive-changes',handler);return function(){socket.off('receive-changes',handler);};},[socket,quill]);useEffect(function(){if(socket==null||quill==null)return;var handler=function handler(delta,oldDelta,source){if(source!=='user')return;socket.emit(\"send-changes\",delta);};quill.on('text-change',handler);return function(){quill.off('text-change',handler);};},[socket,quill]);var wrapperRef=useCallback(function(wrapper){if(wrapper==null)return;wrapper.innderHTML=\"\";var editor=document.createElement(\"div\");wrapper.append(editor);var q=new Quill(editor,{theme:\"snow\",modules:{toolbar:TOOLBAR_OPTIONS}});q.disable();q.setText('Loading...');setQuill(q);},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"container\",ref:wrapperRef});}","map":{"version":3,"sources":["/Users/dannytszho/Desktop/Coding/Open_Source_Projects/google-docs/client/src/TextEditor.js"],"names":["useCallback","useEffect","useState","Quill","io","useParams","SAVE_INTERVAL_MS","TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","documentID","id","socket","setSocket","quill","setQuill","console","log","s","disconnect","once","document","setContents","enable","emit","interval","setInterval","getContents","clearInterval","handler","delta","updateContents","on","off","oldDelta","source","wrapperRef","wrapper","innderHTML","editor","createElement","append","q","theme","modules","toolbar","disable","setText"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useState } from 'react'\nimport Quill from \"quill\"\nimport \"quill/dist/quill.snow.css\"\nimport { io } from 'socket.io-client'\nimport { useParams } from \"react-router-dom\"\n\nconst SAVE_INTERVAL_MS = 200\nconst TOOLBAR_OPTIONS = [\n    [{ header: [1 ,2, 3, 4, 5 ,6, false] }],\n    [{ font: [] }],\n    [{ list: \"ordered\" }, { list: \"bullet\" }],\n    [\"bold\", \"italic\", \"underline\"],\n    [{ color: [] }, { background: [] }],\n    [{ script: \"sub\"}, { script: \"super\" }],\n    [{ align: [] }],\n    [\"image\", \"blockquote\", \"code-block\"],\n    [\"clean\"],\n]\n\nexport default function TextEditor() {\n    const {id: documentID} = useParams()\n    const [socket, setSocket] = useState()\n    const [quill, setQuill] = useState()\n    console.log(documentID)\n\n\n    useEffect(() => {\n        const s = io(\"http://localhost:3001\")\n        setSocket(s)\n\n        return () => {\n            s.disconnect()\n        }\n    }, [])\n\n    useEffect(() => {\n        if (socket == null || quill == null) return\n\n        socket.once('load-document', document => {\n            quill.setContents(document)\n            quill.enable()\n        })\n\n        socket.emit('get-document', documentID)\n\n    }, [socket, quill], documentID)\n\n    useEffect(() => {\n        if (socket == null || quill == null) return\n\n        const interval = setInterval(() => {\n            socket.emit(\"save-document\", quill.getContents())\n        }, SAVE_INTERVAL_MS)\n\n        return ()=> {\n            clearInterval(interval)\n        }\n    }, [socket, quill])\n\n    useEffect(() => {\n        if (socket == null || quill == null) return\n\n        const handler = (delta) => {\n            quill.updateContents(delta)\n        }\n        \n        socket.on('receive-changes', handler)\n\n        return () => {\n            socket.off('receive-changes', handler)\n        }\n    },[socket, quill])\n\n    useEffect(() => {\n        if (socket == null || quill == null) return\n\n        const handler = (delta, oldDelta, source) => {\n            if (source !== 'user') return\n            socket.emit(\"send-changes\", delta)\n        }\n        quill.on('text-change', handler)\n\n        return () => {\n            quill.off('text-change', handler)\n        }\n    },[socket, quill])\n\n    const wrapperRef = useCallback(wrapper => {\n        if (wrapper == null) return\n\n        wrapper.innderHTML = \"\"\n        const editor = document.createElement(\"div\")\n        wrapper.append(editor)\n        const q = new Quill(editor, {\n            theme: \"snow\", \n            modules: { toolbar: TOOLBAR_OPTIONS },\n        })\n        q.disable()\n        q.setText('Loading...')\n        setQuill(q)\n    }, [])\n    return <div className=\"container\" ref={wrapperRef}></div>\n}\n"]},"metadata":{},"sourceType":"module"}